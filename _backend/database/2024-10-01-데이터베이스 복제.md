---
layout: default
title: 데이터베이스 복제
date: 2024-10-01
categories: database
---

#### 마스터 백업 복제 

* 하나의 리더 데이터베이스에 쓰기와 ddl 쿼리를 허용한다. 
* 하나 이상의 백업 또는 대기 데이터베이스들이 리더 데이터베이스로부터 그 쿼리를 수신 받는다.
* 구현 하기 간단하다.
* 리더 데이터베이스에서 읽기를 시도하면 늘 최신 기록을 받을 수 있다.
* 백업/대기 데이터베이스에서 읽기를 시도할 경우 최신 기록이 아닐 수 있다. 아직 전파가 되지 않았을 수 있기 때문이다.
* 다만 결국 업데이트가 이루어지기 때문에 최종 일관성을 획득할 수 있다.

#### 다중 마스터 복제

* 여러개의 리더 데이터베이스에 쓰기와 ddl 쿼리를 허용한다.
* 하나의 이상의 백업/팔로워 데이터베이스가 리더 데이터베이스로 부터 쓰기를 수신 받는다.
* 충돌 해결책이 필요하다.


#### 동기 복제와 비동기 복제

* 동기 복제할 때는 메인 데이터베이스의 쓰기 트랙잭션이 백업/대기 데이터베이스에 쓰기를 완료할 때 까지 잠금될 것이다.
	* 이 복제가 끝날 때까지 다른 트랜잭션의 커밋은 다른 복제본에 커밋하도록 강제한다.
	* 복제본이 여러개라면 일부 복제본에 먼저 커밋하는 옵셥도 가능하다.
* 비동기 복제할 때는 메인 데이터베이스에 쓰기만 해도 쓰기 트랜잭션이 허용된다. 대신 데이터베이스 백엔드가 주기적으로 대기 복사본에 쓴다.
* 쓰기 속도는 빨라진다.
* 다만 데이터베이스가 주기적으로 복사본에 사용하는 프로세스를 사용하므로 CPU 작업량이 늘어난다.


#### 복제의 장점, 단점

##### 장점
* 수평적 확장
* 지역 기반 쿼리가 가능- 지역 당 DB를 유지할 수 있다.

##### 단점
* 최종 일관성의 문제
* 느린 쓰기(동기화의 경우 트랜잭션을 기달려야 하므로)
* 구현이 어려울 수 있다(다중 리더 데이터베이스의 경우).